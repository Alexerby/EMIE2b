
R version 4.3.0 (2023-04-21 ucrt) -- "Already Tomorrow"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Load required libraries
> library(Ecdat)
Loading required package: Ecfun

Attaching package: 'Ecfun'

The following object is masked from 'package:base':

    sign


Attaching package: 'Ecdat'

The following object is masked from 'package:datasets':

    Orange

> library(dynlm)
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

> library(TS)
Loading required package: urca
Loading required package: vars
Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:Ecdat':

    SP500

Loading required package: strucchange
Loading required package: sandwich
Loading required package: lmtest
Loading required package: tseries
Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo 
> library(tseries) # used for jarque.bera.test
> 
> # Load dataset IncomeUK (from package Ecdat)
> data(IncomeUK, package = "Ecdat")
> income <- IncomeUK[, "income"] # Rename the variable to avoid conflict
> 
> ################################################################################
> #                          QUESTION 1: Autoregressive models                    #
> ################################################################################
> 
> # Create lags
> lags <- embed(income, 5)
> lags <- lags[1:(length(income) - 5), ] # Keep only the relevant rows
> 
> for (i in 1:5) {
+     assign(paste0("lag_", i), lags[, i])
+ }
> 
> for (lag in 1:5) {
+     # Create the formula for the current lag
+     formula <- as.formula(paste0("income[6:length(income)] ~ ", paste0("lag_", 1:lag, collapse = " + ")))
+ 
+     # Fit the model with the current lag value
+     model <- lm(formula, data = IncomeUK)
+ 
+     # Add the model object to the list
+     model_list[[lag]] <- model
+ }
Error: object 'model_list' not found
Execution halted
